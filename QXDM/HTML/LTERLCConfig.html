<!doctype html public "-//w3c//dtd xhtml 1.0 strict//en" 
"http://www.w3.org/tr/xhtml1/dtd/xhtml1-strict.dtd">
<html>
<head>
   <meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5" />
   <meta name="DMViewName" content="LTE RLC Config" />
   <meta name="DMViewWidth" content="800" />
   <meta name="DMViewHeight" content="600" />
   <title>LTE RLC Config</title>
   <link rel="stylesheet" href="QXDMStyle.css" />
</head>
<body onunload="Unregister()" onload="Register()">
   <table border="0" width="100%" cellpadding="2">
      <tr>
         <td valign="top" class="noborder">
            <div class="label">
               RLC DL Config</div>
            <table width="100%" id="DL">
               <tr>
                  <th>
                     Parameter</th>
                  <th>
                     SRB1</th>
                  <th>
                     SRB2</th>
                  <th>
                     SRB3</th>
                  <th>
                     SRB4</th>
                  <th>
                  </th>
                  <th>
                     DRB1</th>
                  <th>
                     DRB2</th>
                  <th>
                     DRB3</th>
                  <th>
                     DRB4</th>
               </tr>
               <tr>
                  <td>
                     Config Reason</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     Released RB</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     ADDMOD RB</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     RB Config Index</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     Action</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     RB ID</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     LC ID</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     RB Mode</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     RB Type</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     T Reordering</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     T Status Prohibit</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     SN Length</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
            </table>
            <br />
         </td>
      </tr>
   </table>
   
   <br />
   
   <table border="0" width="100%" cellpadding="2">
      <tr>
         <td valign="top" class="noborder">
            <div class="label">
               RLC UL Config</div>
            <table width="100%" id="UL">
               <tr>
                  <th>
                     Parameter</th>
                  <th>
                     SRB1</th>
                  <th>
                     SRB2</th>
                  <th>
                     SRB3</th>
                  <th>
                     SRB4</th>
                  <th>
                  </th>
                  <th>
                     DRB1</th>
                  <th>
                     DRB2</th>
                  <th>
                     DRB3</th>
                  <th>
                     DRB4</th>
               </tr>
               <tr>
                  <td>
                     Config Reason</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     Released RB</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     ADDMOD RB</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     RB Config Index</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     Action</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     RB ID</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     LC ID</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     RB Mode</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     RB Type</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     Poll PDU</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     Poll Byte</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     T Poll RTX</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     Max RTX Threshold</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     SN Length</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                  </td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
                  <td>
                     -</td>
               </tr>
            </table>
            <br />
         </td>
      </tr>
   </table>
   
   <br />

   <script type="text/jscript">

var IQXDM2;
var Handle             = 0xFFFFFFFF;
var UPDATE_MS          = 1000;
var gMainTickID        = 0;
var PrevIndex          = -1;
var MAXRB              = 4;


function Register()
{
   IQXDM2 = window.external;
   if (IQXDM2 == null)
   {
      window.document.write( "<br />QXDM does not support required interface" );
      return;
   }

   // We start by registering as a client
   Handle = IQXDM2.RegisterClient( "", 0 );
   if (Handle == 0xFFFFFFFF)
   {
      window.document.write( "<br />Unable to register as client" );
   }   
   
   // Get a configuration object
   var clientObject = IQXDM2.ConfigureClientByKeys( Handle );

   if (clientObject == null)
   {
      window.document.write("<br />Failed to get client interface pointer");
      return;
   }

   // Configure logs.      
   clientObject.AddLog( 0xB081 );  
   clientObject.AddLog( 0xB091 );  
   
   clientObject.CommitConfig();     
   
   // Setup the main update timer
   gMainTickID = setInterval( 'ProcessLogs()', UPDATE_MS );
}

// Clean up on unloading the page
function Unregister()
{
   if (gMainTickID != 0)
   {
      window.clearInterval( gMainTickID );
      gMainTickID = 0;
   }

   if (Handle != 0xFFFFFFFF)
   {
      IQXDM2.UnregisterClient( Handle );
   }
}
 
function ProcessLogs()
{
   var LogCodeDL = "[0xB081]";
   var LogCodeUL = "[0xB091]";
   
   var CurrIndex = IQXDM2.GetClientItemCount( Handle ) - 1;
    
   // Make sure there is an item
   if (CurrIndex < 0)
   {
      return;
   } 
   
   if (PrevIndex > CurrIndex)
   {
      // Reset index if it is greater than item count
      PrevIndex = -1;
      return;
   }
   
   for (var i = PrevIndex+1; i <= CurrIndex; i++)
   {
      var Item = IQXDM2.GetClientItem( Handle, i );
      if (Item == null)
      {
         continue;
      }
      
      var Fields = Item.GetItemFields();
      if (Fields == null)
      {
         continue;
      }     
      
      var ItemKey = Item.GetItemKeyText();
      switch (ItemKey)
      {              
         case LogCodeDL:
         {
            PopulateFieldsDL ( Fields );       
         }
         break;
         
         case LogCodeUL:
         {
            PopulateFieldsUL ( Fields );       
         }
         break; 
      }
   }
   
   PrevIndex = CurrIndex;
}

function PopulateFieldsDL( Fields )
{     
   var FieldCount = Fields.GetFieldCount();
   if (FieldCount < 1)
   {
      return;
   }
            
   var version = Fields.GetFieldValueText( 0 );   
   if ( version != 1 )
   {
      return;
   }
   
   var FI = 1;
   var numSP = Fields.GetFieldValueText( FI ); 
   if ( numSP < 1 )
   {
      return;
   }
   
   var subversion = Fields.GetFieldValueText( 4 );
   if ( subversion != 1 || FieldCount < 18 )
   {
      return;
   }  
   
   var CFG_REASON = Fields.GetFieldValueText( 6 );
   var ArraySize = Fields.GetFieldValue ( 7 );
   var NUM_RELEASED_RB = Fields.GetFieldValue ( 8 );
   FI = 9 + ArraySize;
   var NUM_ADDED_MODIFIED_RB = Fields.GetFieldValue( FI );
   
   var ACTION = "-";
   var RB_CFG_IDX = "-";
   FI = 10 + ArraySize;
   if ( NUM_ADDED_MODIFIED_RB > 0 )
   {   
      RB_CFG_IDX = Fields.GetFieldValueText( FI++ );
      ACTION = Fields.GetFieldValueText( FI );
   }
   
   DL.rows[1].cells[1].innerText = CFG_REASON;
   DL.rows[2].cells[1].innerText = NUM_RELEASED_RB;
   DL.rows[3].cells[1].innerText = NUM_ADDED_MODIFIED_RB;
   DL.rows[4].cells[1].innerText = RB_CFG_IDX;
   DL.rows[5].cells[1].innerText = ACTION;
   
   FI = 10 + 3*ArraySize;
   var numActive = Fields.GetFieldValue( FI );
   if ( numActive < 1 )
   {
      return;
   }   
   
   var SRB = new Array();
   var numSRB = 0;
   var DRB = new Array();
   var numDRB = 0;
   FI = 15 + 3*ArraySize;
   var i = 0;
   for ( i = 0; i < numActive; ++i, FI+= 7 )
   {
      var rbType = Fields.GetFieldValue( FI );
      
      if ( rbType == 1 )
      {
         SRB[numSRB++] = Fields.GetFieldValue ( FI - 2 );
      }
      else if ( rbType == 2 )
      {
         DRB[numDRB++] = Fields.GetFieldValue ( FI - 2 );
      }
   }
   SRB.sort();
   DRB.sort();  
   
   FI = 11 + 3*ArraySize;
   var i = 0, j = 0;
   for ( i = 0; i < numActive; ++i, FI+= 7 )
   {
      var RB_ID = Fields.GetFieldValue( FI+2 );
      var LC_ID = Fields.GetFieldValueText( FI+1 );
      var RB_MODE = Fields.GetFieldValue( FI );
      var RB_TYPE = Fields.GetFieldValue( FI+4 );   
      var RB_INDEX = Fields.GetFieldValue( FI+3 ); 
      var T_REORDERING = "-";
      var T_STATUS_PROHIBIT = "-";
      var SN_LEN = "-";
      
      if ( RB_MODE == 1 )
      {
         T_REORDERING = Fields.GetFieldValueText( FI+5 );  
         T_STATUS_PROHIBIT = Fields.GetFieldValueText( FI+6 ); 
      }
      else if ( RB_MODE == 2 )
      {
         SN_LEN = Fields.GetFieldValueText( FI+6 );
      }
      
      if ( RB_TYPE == 1 )
      {
         for ( j = 0; j < numSRB; ++j )
         {
            if ( SRB[j] == RB_ID )
            {
               break;
            }
         }
      }
      else if ( RB_TYPE == 2 )
      {
         for ( j = 0; j < numDRB; ++j )
         {
            if ( DRB[j] == RB_ID )
            {
               break;
            }
         }    
      }
      if ( j > MAXRB )
      {
         continue;
      }
      if ( RB_TYPE == 1 )
      {
         j += 1;
      } 
      else if ( RB_TYPE == 2 )
      {
         j += 6;
      } 
      DL.rows[4].cells[j].innerText = RB_INDEX;
      DL.rows[6].cells[j].innerText =  RB_ID;
      DL.rows[7].cells[j].innerText =  LC_ID;
      DL.rows[8].cells[j].innerText =  RB_MODE;
      DL.rows[9].cells[j].innerText =  RB_TYPE;
      DL.rows[10].cells[j].innerText =  T_REORDERING;
      DL.rows[11].cells[j].innerText =  T_STATUS_PROHIBIT;
      DL.rows[12].cells[j].innerText =  SN_LEN;
   }  
                       
}

function PopulateFieldsUL( Fields )
{     
   var FieldCount = Fields.GetFieldCount();
   if (FieldCount < 1)
   {
      return;
   }
            
   var version = Fields.GetFieldValueText( 0 );   
   if ( version != 1 )
   {
      return;
   }
   
   var FI = 1;
   var numSP = Fields.GetFieldValueText( FI ); 
   if ( numSP < 1 )
   {
      return;
   }
   
   var subversion = Fields.GetFieldValueText( 4 );
   if ( subversion != 1 || FieldCount < 18 )
   {
      return;
   }  
   
   var CFG_REASON = Fields.GetFieldValueText( 6 );
   var ArraySize = Fields.GetFieldValue ( 7 );
   var NUM_RELEASED_RB = Fields.GetFieldValue ( 8 );
   FI = 9 + ArraySize;
   var NUM_ADDED_MODIFIED_RB = Fields.GetFieldValue( FI );
   
   var ACTION = "-";
   var RB_CFG_IDX = "-";
   FI = 10 + ArraySize;
   if ( NUM_ADDED_MODIFIED_RB > 0 )
   {   
      RB_CFG_IDX = Fields.GetFieldValueText( FI++ );
      ACTION = Fields.GetFieldValueText( FI );
   }
   
   UL.rows[1].cells[1].innerText = CFG_REASON;
   UL.rows[2].cells[1].innerText = NUM_RELEASED_RB;
   UL.rows[3].cells[1].innerText = NUM_ADDED_MODIFIED_RB;
   UL.rows[4].cells[1].innerText = RB_CFG_IDX;
   UL.rows[5].cells[1].innerText = ACTION;
   
   FI = 10 + 3*ArraySize;
   var numActive = Fields.GetFieldValue( FI );
   if ( numActive < 1 )
   {
      return;
   }   
   
   var SRB = new Array();
   var numSRB = 0;
   var DRB = new Array();
   var numDRB = 0;
   FI = 15 + 3*ArraySize;
   var i = 0;
   for ( i = 0; i < numActive; ++i )
   {
      var rbType = Fields.GetFieldValue( FI );
      var rbMode = Fields.GetFieldValue( FI-4 );
      
      if ( rbType == 1 )
      {
         SRB[numSRB++] = Fields.GetFieldValue ( FI - 2 );
      }
      else if ( rbType == 2 )
      {
         DRB[numDRB++] = Fields.GetFieldValue ( FI - 2 );
      }
      
      if ( rbMode == 1 )
      {
         FI += 9;         
      }
      else if ( rbMode == 2 )
      {
         FI += 6;
      }
     
   }
   SRB.sort();
   DRB.sort();  
   
   FI = 11 + 3*ArraySize;
   var i = 0, j = 0;
   for ( i = 0; i < numActive; ++i )
   {
      var RB_ID = Fields.GetFieldValue( FI+2 );
      var LC_ID = Fields.GetFieldValueText( FI+1 );
      var RB_MODE = Fields.GetFieldValue( FI );
      var RB_TYPE = Fields.GetFieldValue( FI+4 );   
      var RB_INDEX = Fields.GetFieldValue( FI+3 ); 
      var POLL_PDU = "-";
      var POLL_BYTE = "-";
      var T_POLL_RTX = "-";
      var MAX_RTX_THRESHOLD = "-";
      var SN_LEN = "-";
       
      if ( RB_MODE == 1 )
      {
         POLL_PDU = Fields.GetFieldValueText( FI+5 );  
         POLL_BYTE = Fields.GetFieldValueText( FI+6 );  
         T_POLL_RTX = Fields.GetFieldValueText( FI+7 );  
         MAX_RTX_THRESHOLD = Fields.GetFieldValueText( FI+8 );  
         FI += 9;
      }
      else if ( RB_MODE == 2 )
      {
         SN_LEN = Fields.GetFieldValueText( FI+5 );
         FI += 6;
      }
      
      if ( RB_TYPE == 1 )
      {
         for ( j = 0; j < numSRB; ++j )
         {
            if ( SRB[j] == RB_ID )
            {
               break;
            }
         }
      }
      else if ( RB_TYPE == 2 )
      {
         for ( j = 0; j < numDRB; ++j )
         {
            if ( DRB[j] == RB_ID )
            {
               break;
            }
         }    
      }
      if ( j > MAXRB )
      {
         continue;
      }
      if ( RB_TYPE == 1 )
      {
         j += 1;
      } 
      else if ( RB_TYPE == 2 )
      {
         j += 6;
      } 
      
      UL.rows[4].cells[j].innerText = RB_INDEX;
      UL.rows[6].cells[j].innerText =  RB_ID;
      UL.rows[7].cells[j].innerText =  LC_ID;
      UL.rows[8].cells[j].innerText =  RB_MODE;
      UL.rows[9].cells[j].innerText =  RB_TYPE;
      UL.rows[10].cells[j].innerText =  POLL_PDU;
      UL.rows[11].cells[j].innerText =  POLL_BYTE;
      UL.rows[12].cells[j].innerText =  T_POLL_RTX;
      UL.rows[13].cells[j].innerText =  MAX_RTX_THRESHOLD;
      UL.rows[14].cells[j].innerText =  SN_LEN;
      
   }  
                       
}
   </script>

</body>
</html>
