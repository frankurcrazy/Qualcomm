<!doctype html public "-//w3c//dtd xhtml 1.0 strict//en" 
"http://www.w3.org/tr/xhtml1/dtd/xhtml1-strict.dtd">
<html>
<head>
   <meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5" />
   <meta name="DMViewName" content="LTE Mac Config" />
   <meta name="DMViewWidth" content="800" />
   <meta name="DMViewHeight" content="600" />
   <title>LTE Mac Config</title>
   <link rel="stylesheet" href="QXDMStyle.css" />
</head>
<body onunload="Unregister()" onload="Register()">
   <table border="0" width="100%" cellpadding="2">
      <tr>
         <td valign="top" class="noborder" style="width: 50%">
            <div class="label">
               MAC Timer</div>
            <table width="100%" id="MACTimer">
               <colgroup span="2">
                  <col width="60%" />
                  <col width="40%" />
               </colgroup>
               <tr>
                  <th>
                     Parameter</th>
                  <th>
                     Value</th>
               </tr>
               <tr>
                  <td>
                     RA RSP Win Size</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     TA Timer</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     BSR Timer</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     RETX BSR Timer</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     SR Periodicity</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     Contention Resolution Timer</td>
                  <td>
                     -</td>
               </tr>
 
            </table>
            <br />
         </td>
         <td valign="top" class="noborder" style="width: 50%">
            <div class="label">
               RACH Config</div>
            <table width="100%" id="RACHConfig">
               <colgroup span="2">
                  <col width="60%" />
                  <col width="40%" />
               </colgroup>
               <tr>
                  <th>
                     Parameter</th>
                  <th>
                     Value</th>
               </tr>
               <tr>
                  <td>
                     Preamble Initial Power</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     Power Ramping Step</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     RA Index1</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     RA Index2</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     Preamble Trans Max</td>
                  <td>
                     -</td>
               </tr>
               <tr>
                  <td>
                     MAX RETX MSG3</td>
                  <td>
                     -</td>
               </tr>
            </table>
            <br />
         </td>
      </tr>
   </table>
   <table border="0" width="100%" cellpadding="2">
      <td valign="top" class="noborder" style="width: 100%">
         <div class="label">
            Active LC ID Configuration</div>
         <table width="100%" id="LC">
            <tr>
               <th style="height: 20px">
                  LC ID</th>
               <th style="height: 20px">
                  PBR</th>
               <th style="height: 20px">
                  Priority</th>
               <th style="height: 20px">
                  LC Group</th>
               <th style="height: 20px">
                  Bucket Size</th>
            </tr>
            <tr>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
            </tr>
            <tr>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
            </tr>
            <tr>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
            </tr>
            <tr>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
            </tr>
            <tr>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
            </tr>
            <tr>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
            </tr>
            <tr>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
            </tr>
            <tr>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
            </tr>
            <tr>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
            </tr>
            <tr>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
               <td>
                  -</td>
            </tr>
         </table>
         <br />
      </td>
   </table>

   <script type="text/jscript">

var IQXDM2;
var Handle             = 0xFFFFFFFF;
var UPDATE_MS          = 1000;
var gMainTickID        = 0;
var PrevIndex          = -1;


function Register()
{
   IQXDM2 = window.external;
   if (IQXDM2 == null)
   {
      window.document.write( "<br />QXDM does not support required interface" );
      return;
   }

   // We start by registering as a client
   Handle = IQXDM2.RegisterClient( "", 0 );
   if (Handle == 0xFFFFFFFF)
   {
      window.document.write( "<br />Unable to register as client" );
   }   
   
   // Get a configuration object
   var clientObject = IQXDM2.ConfigureClientByKeys( Handle );

   if (clientObject == null)
   {
      window.document.write("<br />Failed to get client interface pointer");
      return;
   }

   // Configure logs.      
   clientObject.AddLog( 0xB060 );  
   
   clientObject.CommitConfig();     
   
   // Setup the main update timer
   gMainTickID = setInterval( 'ProcessLogs()', UPDATE_MS );
}

// Clean up on unloading the page
function Unregister()
{
   if (gMainTickID != 0)
   {
      window.clearInterval( gMainTickID );
      gMainTickID = 0;
   }

   if (Handle != 0xFFFFFFFF)
   {
      IQXDM2.UnregisterClient( Handle );
   }
}
 
function ProcessLogs()
{
   var LogCode = "[0xB060]";
   
   var CurrIndex = IQXDM2.GetClientItemCount( Handle ) - 1;
   
   // Make sure there is an item
   if (CurrIndex < 0)
   {
      return;
   } 
   
   if (PrevIndex > CurrIndex)
   {
      // Reset index if it is greater than item count
      PrevIndex = -1;
      return;
   }
   
   for (var i = PrevIndex+1; i <= CurrIndex; i++)
   {
      var Item = IQXDM2.GetClientItem( Handle, i );
      if (Item == null)
      {
         continue;
      }
      
      var Fields = Item.GetItemFields();
      if (Fields == null)
      {
         continue;
      }     
      
      var ItemKey = Item.GetItemKeyText();
      switch (ItemKey)
      {              
         case LogCode:
         {
            PopulateFields ( Fields );       
         }
         break; 
      }
   }
   
   PrevIndex = CurrIndex;
}

function PopulateFields( Fields )
{     
   var FieldCount = Fields.GetFieldCount();
   if (FieldCount < 1)
   {
      return;
   }
            
   var version = Fields.GetFieldValueText( 0 );   
   if ( version != 1 || FieldCount < 6 )
   {
      return;
   }
   
   var FI = 1;
   if (FieldCount < FI)
   {
      return;
   }
   
   var numSP = Fields.GetFieldValueText( FI ); 
   if ( numSP < 1 )
   {
      return;
   }
   
   FI = 3;   
   for ( ; numSP > 0; numSP-- )
   {
      var version = Fields.GetFieldValue( FI+1 );
      if ( version != 1 )
      {
         return;
      }  
      var ID = Fields.GetFieldValue( FI );  
      
      FI += 3;
      switch ( ID )
      {
         case 0:
         {
            FI += 3;
         };
         break;
         case 1:
         {
            if (FieldCount < FI+2)
            {
               return;
            }
            var FT = Fields.GetFieldValueText( FI ); 
            MACTimer.rows[2].cells[1].innerText = FT;  
            FI += 2;
         }
         break;
         case 2:
         {
            if (FieldCount < FI+6)
            {
               return;
            }
            var FT = Fields.GetFieldValueText( FI+1 ); 
            MACTimer.rows[5].cells[1].innerText = FT;
            
            var FT = Fields.GetFieldValueText( FI+2 ); 
            MACTimer.rows[3].cells[1].innerText = FT;
              
            var FT = Fields.GetFieldValueText( FI+4 ); 
            MACTimer.rows[4].cells[1].innerText = FT;
            FI += 6;
         }
         break;
         case 3:
         {
            if (FieldCount < FI+18)
            {
               return;
            }
            var FT = Fields.GetFieldValueText( FI ); 
            RACHConfig.rows[1].cells[1].innerText = FT;  
            
            var FT = Fields.GetFieldValueText( FI+1 ); 
            RACHConfig.rows[2].cells[1].innerText = FT; 
            
            var FT = Fields.GetFieldValueText( FI+2 ); 
            RACHConfig.rows[3].cells[1].innerText = FT; 
            
            var FT = Fields.GetFieldValueText( FI+3 ); 
            RACHConfig.rows[4].cells[1].innerText = FT; 
            
            var FT = Fields.GetFieldValueText( FI+4 ); 
            RACHConfig.rows[5].cells[1].innerText = FT;  
            
            var FT = Fields.GetFieldValueText( FI+15 ); 
            RACHConfig.rows[6].cells[1].innerText = FT;
            
            var FT = Fields.GetFieldValueText( FI+5 ); 
            MACTimer.rows[6].cells[1].innerText = FT; 
            
            var FT = Fields.GetFieldValueText( FI+16 ); 
            MACTimer.rows[1].cells[1].innerText = FT; 
            
            FI += 18;
         }
         break;
         case 4:
         {
            if (FieldCount < FI+2)
            {
               return;
            }
            var deletedLC = Fields.GetFieldValue( FI ); 
            FI = FI+1+32;
            var activeLC = Fields.GetFieldValue( FI );
            
            FI++;
            var i = 1; 
            for ( i = 1; i <= activeLC; ++ i )
            {      
               if (FieldCount < FI+5)
               {
                  return;
               }
               var id = Fields.GetFieldValueText( FI++ ); 
               var pbr = Fields.GetFieldValueText( FI++ ); 
               var priority = Fields.GetFieldValueText( FI++ ); 
               var group = Fields.GetFieldValueText( FI++ ); 
               var size = Fields.GetFieldValueText( FI++ ); 
               
               LC.rows[i].cells[0].innerText = id;
               LC.rows[i].cells[1].innerText = pbr;
               LC.rows[i].cells[2].innerText = priority;
               LC.rows[i].cells[3].innerText = group;
               LC.rows[i].cells[4].innerText = size;
            } 
         }
         break;
      }
   }
                     
}

   </script>

</body>
</html>
